package lab.cgcl.myOCR.util;

import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;

import lab.cgcl.requestClient.domain.CaUser;

import org.apache.commons.beanutils.ConvertUtils;
import org.apache.commons.beanutils.PropertyUtils;

public class BeanUtil {
	
	/**
	 * 把一个map封装成一个bean
	 * @param map
	 * @param obj
	 * @return 
	 * @return
	 */
	public static <T> T wrapMap2Bean(Map map , Class clazz){
		Object obj = null;
		try {
			obj = clazz.newInstance();
		} catch (InstantiationException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (IllegalAccessException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
			
		//遍历所有名称
		Iterator it = map.keySet().iterator();
		while(it.hasNext()){
			//取得名称
		    String name = it.next().toString();
		    if ( map.get(name) != null) {
		    	//取得值
		    	String value = map.get(name).toString();
		    	try{
				     //取得值的类形
				    Class type = PropertyUtils.getPropertyType(obj, name);
				    
				    if(type!=null){
				      //设置参数
				      PropertyUtils.setProperty(obj, name,ConvertUtils.convert(value, type));
				     }
				}catch(Exception ex){
				     ex.printStackTrace();
				}
		    }
		    
   
		}
		T ret =null;
		try {
			ret = (T)obj;
		} catch (Exception e){
			e.printStackTrace();
		}
		return ret;
	}
	
	public static void main(String[] args) {
		Map param = new HashMap();
		param.put("username", "qwe");
		param.put("pwd", "123");
		//CaUser user = new CaUser();
		CaUser user = wrapMap2Bean(param, CaUser.class );
		System.out.println(user.toString());
	}
}
